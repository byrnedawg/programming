{"filter":false,"title":"DigitalDice_SingleDigit.c","tooltip":"/avr/notes/beginC/DigitalDice_SingleDigit.c","undoManager":{"mark":4,"position":4,"stack":[[{"start":{"row":0,"column":0},"end":{"row":134,"column":3},"action":"insert","lines":["/*"," * DigitalDice_SingleDigit.c"," * Written in AVR Studio 5"," * Compiler: AVR GNU C Compiler (GCC)"," *"," * Created: 5/27/2011 10:50:48 PM"," * Author: AVR Tutorials"," * Website: www.AVR-Tutorials.com"," *"," * Description: AVR C program for ATMega16 Seven Segment "," * Single Digit Digital Dice Project"," */ "," ","#define DicePort\t\tPORTA","#define DicePortDDR\t\tDDRA"," ","#define SwitchPortDDR\t\tDDRD","#define SwitchPort\t\tPORTD","#define SwitchPin\t\tPIND"," ","#define RollSwitch\t\t7"," ","#define F_CPU\t\t\t4000000UL"," ","#include <avr/io.h>","#include <stdlib.h>","#include <util/delay.h>","#include <avr/interrupt.h>"," ","unsigned char seed = 0;"," ","/*Declaration of functions. The implementation of these */","/*function are done below the main() function*/","unsigned char digit_to_7segval(unsigned char digit);","void roll_dice(unsigned char times);","void init();","ISR(TIMER0_OVF_vect);"," "," ","int main(void)","{\t","\tunsigned char digit = 0;"," ","\tinit();\t// Configure the Microcontroller"," ","    /*Do forever*/","\twhile(1)","\t{"," ","\t\tif(!(SwitchPin & (1<<RollSwitch)))","\t\t{","\t\t\t/*Roll the dice 2 times*/","\t\t\troll_dice(2);"," ","\t\t\t/*Generate an integer based random number between */","\t\t\t/*1 and 6 inclusive and store it in digit*/","\t\t\tseed = (seed*17)+21;","\t\t\tdigit = seed % 6;","\t\t\tdigit++;"," ","\t\t\t/*Get the Seven Segment value of the random number*/","\t\t\t/*and output it to the pins of port B*/\t","\t\t\tDicePort = digit_to_7segval(digit); ","\t\t}\t\t\t","\t}\t\t"," ","}"," ","/*Configuration for the microcontroller*/","void init()","{","\t/*Configure DicePort as an output port*/","\tDicePortDDR = 0xFF;"," ","\t/*Configure SwitchPort as an input port*/","\tSwitchPortDDR = 0x00;","\t/*Enable SwitchPort pull-up resistors*/","\tSwitchPort = 0xFF;"," ","\tTCCR0 = 0x01;   // Enable Timer0 with no prescalar","\tTIMSK = 0x01;   // Enable Timer0 interrupt","\tsei();\t\t\t// Enable Global Interrupt","}\t"," ","/*This function takes an character value and return the */","/*and return the value to be outputted to display that */","/*character on a seven segment display*/","unsigned char digit_to_7segval(unsigned char digit)","{","\tunsigned char segval = '0';"," ","\tif(digit == 1)","\t\tsegval = 0x06;\t\t// 7-Seg Value for Digit 1","\telse if (digit == 2)","\t\tsegval = 0x5B;\t\t// 7-Seg Value for Digit 2","\telse if (digit == 3)","\t\tsegval = 0x4F;\t\t// 7-Seg Value for Digit 3","\telse if (digit == 4)","\t\tsegval = 0x66;\t\t// 7-Seg Value for Digit 4","\telse if (digit == 5)","\t\tsegval = 0x6D;\t\t// 7-Seg Value for Digit 5","\telse if (digit == 6)","\t\tsegval = 0x7D;\t\t// 7-Seg Value for Digit 6"," ","\treturn segval;","}"," ","/*This function simulates the rolling of the dice*/","void roll_dice(unsigned char times)","{","\tunsigned char i;"," ","\tfor(i=0; i<times; i++)","\t{","\t\tDicePort = 0x06;\t// Display #1 on dice","\t\t_delay_ms(100);","\t\tDicePort = 0x5B;\t// Display #2 on dice","\t\t_delay_ms(100);","\t\tDicePort = 0x4F;\t// Display #3 on dice","\t\t_delay_ms(100);","\t\tDicePort = 0x66;\t// Display #4 on dice","\t\t_delay_ms(100);","\t\tDicePort = 0x6D;\t// Display #5 on dice","\t\t_delay_ms(100);","\t\tDicePort = 0x7D;\t// Display #6 on dice","\t\t_delay_ms(100);"," ","\t}\t\t","}"," ","/*Interrupt Service Routine for timer overflow*/","ISR(TIMER0_OVF_vect)","{","\tseed++; // Increment the value in the variable seed","}\t\t"],"id":1}],[{"start":{"row":22,"column":15},"end":{"row":22,"column":16},"action":"remove","lines":["\t"],"id":2}],[{"start":{"row":22,"column":14},"end":{"row":22,"column":15},"action":"remove","lines":["\t"],"id":3}],[{"start":{"row":22,"column":13},"end":{"row":22,"column":14},"action":"remove","lines":["\t"],"id":4}],[{"start":{"row":22,"column":13},"end":{"row":22,"column":14},"action":"insert","lines":[" "],"id":5}]]},"ace":{"folds":[],"scrolltop":998,"scrollleft":0,"selection":{"start":{"row":22,"column":23},"end":{"row":22,"column":23},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":57,"state":"start","mode":"ace/mode/c_cpp"}},"timestamp":1475103341884,"hash":"36ff096525f5029716aa8b8efce5ffd3b9cded00"}